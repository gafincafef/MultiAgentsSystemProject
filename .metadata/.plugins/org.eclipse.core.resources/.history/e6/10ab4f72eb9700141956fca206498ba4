package edu.rits.ma.jade.behaviour;

import jade.core.Agent;
import jade.core.behaviours.CyclicBehaviour;
import edu.rits.ma.common.ITask;
import edu.rits.ma.jade.dataobject.IResponse;
import edu.rits.ma.jade.dataobject.ResponseImpl;

public class SingleTaskProcessorBehaviour extends CyclicBehaviour {

	private static final int NB_TASK_COMPLETED = 1;
	/**
	 * 
	 */
	private static final long serialVersionUID = -949869179196957814L;
	private boolean mTaskProcessed = false;
	
	public SingleTaskProcessorBehaviour(Agent agent) {
		super();
		setAgent(agent);
	}
	
	@Override
	public void action() {
		ITask task = getAssignedTask();
		if(task != null) {
			task.execute();
			responseToPrimaryAgent();
		}
		else {
			block();
		}
	}

	private ITask getAssignedTask() {
		return (ITask) getAgent().getO2AObject();
	}
	
	private void responseToPrimaryAgent() {
		IResponse response = new ResponseImpl();
		response.setResponseValue(NB_TASK_COMPLETED);
		getAgent().registerO2AInterface(IResponse.class, response);
	}
	
	
}
